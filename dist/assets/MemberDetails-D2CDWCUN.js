import{k as R,l as g,m as A,ag as O,ah as P,e as G,f as W,w as M,M as Y,o as c,b as V,O as J,a as t,u as K,t as a,d as T,c as _,H as f,G as p,N as Q,z as X}from"./index-DIUjx3mN.js";import{L as Z}from"./logo-dark-vFYSVGr0.js";import{u as B,w as tt}from"./xlsx-D1NZSDnX.js";import{_ as et}from"./_plugin-vue_export-helper-DlAUqK2U.js";const st={class:"d-flex justify-space-between align-content-start mb-6"},ot={class:"logo"},nt=["src"],at={class:"v-btn v-theme--BLUE_THEME bg-success v-btn--density-default v-btn--size-default v-btn--variant-flat",style:{"border-radius":"50px"},draggable:"false"},lt={class:"v-chip__content","data-no-activator":""},rt={class:"mb-6"},it={class:"v-row"},ut={class:"v-col-lg-4 v-col-12"},ct={class:"text-1 mb-3 font-weight-medium",style:{color:"#f6c000"}},dt={class:"text-14 textSecondary lh-normal"},mt={class:"mb-1"},_t={class:"mb-1"},pt={class:"mb-1"},vt={class:"v-table v-theme--BLUE_THEME v-table--density-default month-table"},ht={class:"v-table__wrapper"},ft={class:"month-item"},bt={class:"text-p",style:{"font-size":"12px","font-weight":"600",color:"#725AF2"}},yt={class:"month-item"},xt={class:"text-p",style:{"font-size":"13px","font-weight":"400"}},gt={class:"month-item"},wt={class:"text-p",style:{"font-size":"13px","font-weight":"400"}},kt={class:"month-item"},Et={class:"text-p",style:{"font-size":"13px","font-weight":"400"}},zt={class:"month-item"},Nt={class:"text-p",style:{"font-size":"13px","font-weight":"400"}},Ct={class:"text-p",style:{"font-size":"13px","font-weight":"400"}},Dt={class:"v-row d-flex justify-end border-t mt-1"},Lt={class:"v-col-md-4 v-col-12 mt-4"},Mt={class:"d-flex align-center justify-space-between text-14 font-weight-semibold mb-4"},Tt={class:"text-1"},Bt={class:"d-flex align-center justify-space-between text-14 font-weight-semibold mb-4"},jt={class:"text-1"},St={class:"d-flex align-center justify-space-between text-14 font-weight-semibold mb-4"},Vt={class:"text-1"},It={class:"d-flex align-center justify-space-between text-14 font-weight-semibold"},$t={class:"text-1"},qt=R({__name:"MemberDetails",props:{monthName:{},quarter:{}},setup(Ht){const I=X(),D=O();localStorage.getItem("user_id"),localStorage.getItem("user_role");const L=g(null),E=g(null),z=g(null),u=g(null),v=g({});A(()=>{L.value=parseInt(D.query.memberId1),E.value=D.query.buddhist_year,z.value=D.query.month_number,$()});const $=async()=>{if(L.value)try{const e=await(await fetch(`https://thhbaadmin.infinityfreeapp.com/backend/get_members_master-D.php?id=${L.value}&buddhist_year=${E.value}&month_number=${z.value}`)).json();if(console.log(e),u.value=e.user_info,v.value=e.data,console.log("data.value:",v.value),v.value&&Object.keys(v.value).length>0){const o={};for(const l in v.value){const n=l.trim();o[n]={};for(const x in v.value[l])o[n][x.trim()]=P(v.value[l][x])}b.value=o,console.log(b.value)}else console.error("No data available in the response.")}catch(s){console.error("❌ Error fetching contract data:",s)}},j=["ไม่เกิน 2.50 ล้านบาท","2.51 - 5 ล้านบาท","5.01 - 10 ล้านบาท","10.01 - 20 ล้านบาท","20.01 ล้านขึ้นไป"],i=["กรุงเทพปริมณฑล","ภาคเหนือ","ภาคตะวันออกเฉียงเหนือ","ภาคกลาง","ภาคตะวันออก","ภาคใต้","ภาคตะวันตก"],b=g({}),S=s=>{const e=["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],o=parseInt(s)-1;return e[o]||""},y=s=>{const e=Number(s);return isNaN(e)?"-":e.toLocaleString("th-TH",{style:"currency",currency:"THB"}).replace("฿","")+" บาท"};function d(s,e,o){var k;if(!s||!e||!o)return"-";const l=s.trim().toLowerCase(),n=e.trim().toLowerCase(),w=(b.value??{})[l];if(w&&w[n]){const r=(k=w[n])==null?void 0:k[o];if(r!=null)return o==="avg_price_per_sqm"&&typeof r=="number"?r.toFixed(2):typeof r=="number"?r.toLocaleString():String(r)}return"-"}function m(s){var o;let e=0;for(const l in b.value)for(const n in b.value[l])e+=((o=b.value[l][n])==null?void 0:o[s])??0;return e}const q=()=>{I.back()},H=()=>{const s=[];s.push(["รายละเอียดของสมาชิก","","","","","","",""]),s.push([`ชื่อ: ${u.value.fullname}`,"","","","","","",""]),s.push([`ประจำเดือน: ${S(z.value)} ปี ${E.value}`,"","","","","","",""]),s.push([`Email: ${u.value.email}`,"","","","","","",""]),s.push([`ประเภทสมาชิก: ${u.value.member_type}`,"","","","","","",""]),s.push([]),j.forEach(r=>{s.push([r,"","","","","","",""]);const N=i.map(h=>d(h,r,"total_units")),C=i.map(h=>d(h,r,"total_value")),F=i.map(h=>d(h,r,"total_area")),U=i.map(h=>d(h,r,"avg_price_per_sqm"));s.push(["จำนวนหลัง",...N]),s.push(["มูลค่ารวม",...C]),s.push(["พื้นที่ใช้สอย",...F]),s.push(["ราคาเฉลี่ย ตร.ม",...U]),s.push([])});const e=m("total_units"),o=m("total_value"),l=m("total_area"),n=o/l;s.push(["สรุปข้อมูลยอดเซ็นสัญญา","","","","","","",""]),s.push(["จำนวนหลัง",y(e)]),s.push(["มูลค่ารวม",y(o)]),s.push(["พื้นที่ใช้สอย",y(l)]),s.push(["ราคาเฉลี่ย ตร.ม",n.toFixed(2)]);const x=B.aoa_to_sheet(s),w=s[0].map((r,N)=>({wch:Math.max(...s.map(C=>C[N]?C[N].toString().length:0))}));x["!cols"]=w;const k=B.book_new();B.book_append_sheet(k,x,"Data"),tt(k,"report.xlsx")};return(s,e)=>u.value?(c(),G(Y,{key:0},{default:M(()=>[V(Q,null,{default:M(()=>[V(J,null,{default:M(()=>[t("div",st,[t("div",ot,[t("img",{src:K(Z),alt:"home"},null,8,nt)]),t("div",null,[t("span",at,[e[0]||(e[0]=t("span",{class:"v-chip__underlay"},null,-1)),t("div",lt,a(u.value.status),1)])])]),t("div",rt,[t("div",it,[t("div",ut,[t("h2",ct,"รายละเอียดของ "+a(u.value.fullname),1),t("div",dt,[t("p",mt,[e[1]||(e[1]=t("span",{style:{color:"#000"},class:"font-weight-medium"},"ประจำเดือน :",-1)),T(" "+a(S(z.value))+" ปี "+a(E.value),1)]),t("p",_t,[e[2]||(e[2]=t("span",{style:{color:"#000"},class:"font-weight-medium"},"Email:",-1)),T(" "+a(u.value.email),1)]),t("p",pt,[e[3]||(e[3]=t("span",{style:{color:"#000"},class:"font-weight-medium"},"ประเภทสมาชิก:",-1)),T(" "+a(u.value.member_type),1)])])])])]),t("div",vt,[t("div",ht,[t("table",null,[t("thead",null,[t("tr",null,[e[4]||(e[4]=t("th",null,null,-1)),(c(),_(p,null,f(i,o=>t("th",{key:o,class:"text-p",style:{"font-size":"13px"}},a(o),1)),64))])]),t("tbody",null,[(c(),_(p,null,f(j,(o,l)=>(c(),_(p,{key:l},[t("tr",ft,[t("td",null,[t("h6",bt,a(o),1)]),(c(),_(p,null,f(i,n=>t("td",{key:n},e[5]||(e[5]=[t("h6",{class:"text-subtitle-1"},null,-1)]))),64))]),t("tr",yt,[e[6]||(e[6]=t("td",null,[t("h6",{class:"text-p",style:{"font-size":"12px","font-weight":"400"}},"จำนวนหลัง")],-1)),(c(),_(p,null,f(i,n=>t("td",{key:n},[t("h6",xt,a(d(n,o,"total_units")),1)])),64))]),t("tr",gt,[e[7]||(e[7]=t("td",null,[t("h6",{class:"text-p",style:{"font-size":"12px","font-weight":"400"}},"มูลค่ารวม")],-1)),(c(),_(p,null,f(i,n=>t("td",{key:n},[t("h6",wt,a(d(n,o,"total_value")),1)])),64))]),t("tr",kt,[e[8]||(e[8]=t("td",null,[t("h6",{class:"text-p",style:{"font-size":"12px","font-weight":"400"}},"พื้นที่ใช้สอย")],-1)),(c(),_(p,null,f(i,n=>t("td",{key:n},[t("h6",Et,a(d(n,o,"total_area")),1)])),64))]),t("tr",zt,[e[9]||(e[9]=t("td",null,[t("h6",{class:"text-p",style:{"font-size":"12px","font-weight":"400"}},"ราคาเฉลี่ย ตร.ม")],-1)),(c(),_(p,null,f(i,n=>t("td",{key:n},[t("h6",Nt,[t("h6",Ct,a(d(n,o,"avg_price_per_sqm")),1)])])),64))])],64))),64))])])])]),t("div",Dt,[t("div",Lt,[t("div",Mt,[e[10]||(e[10]=t("p",{class:"text-muted"},"จำนวนหลัง",-1)),t("h4",Tt,a(y(m("total_units"))),1)]),t("div",Bt,[e[11]||(e[11]=t("p",{class:"text-muted"},"มูลค่ารวม",-1)),t("h4",jt,a(y(m("total_value"))),1)]),t("div",St,[e[12]||(e[12]=t("p",{class:"text-muted"},"พื้นที่ใช้สอย",-1)),t("h4",Vt,a(y(m("total_area"))),1)]),t("div",It,[e[13]||(e[13]=t("p",{class:"text-muted"},"ราคาเฉลี่ย",-1)),t("h4",$t,a((m("total_value")/m("total_area")).toFixed(2))+" ตร.ม",1)])])]),t("div",{class:"d-flex ga-3 justify-end mt-6"},[t("a",{class:"v-btn v-btn--flat v-theme--BLUE_THEME bg-warning v-btn--density-default v-btn--size-default v-btn--variant-elevated",onClick:q},e[14]||(e[14]=[t("span",{class:"v-btn__overlay"},null,-1),t("span",{class:"v-btn__underlay"},null,-1),t("span",{class:"v-btn__content","data-no-activator":""},"กลับไปหน้าหลัก",-1)])),t("a",{class:"v-btn v-btn--flat v-theme--BLUE_THEME bg-primary v-btn--density-default v-btn--size-default v-btn--variant-elevated",onClick:H},e[15]||(e[15]=[t("span",{class:"v-btn__overlay"},null,-1),t("span",{class:"v-btn__underlay"},null,-1),t("span",{class:"v-btn__content","data-no-activator":""},"expost to Excel",-1)]))])]),_:1})]),_:1})]),_:1})):W("",!0)}}),Ot=et(qt,[["__scopeId","data-v-002be376"]]);export{Ot as default};
